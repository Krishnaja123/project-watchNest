<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        <%= title %>
    </title>
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</head>

<body>
    <header>
        <div class="top-bar">
            <div class="logo-search-container">
                <div class="logo">WATCH NEST</div>
                <div class="search-bar">
                    <input type="text" placeholder="Search products...">
                </div>
            </div>

            <div class="nav-buttons">
    <a href="/home" class="nav-button">
        <i class="fas fa-home"></i>
    </a>

    <a href="/wishlist" class="nav-button">
        <i class="fas fa-heart"></i>
    </a>

    <a href="/cart" class="nav-button">
        <i class="fas fa-shopping-cart"></i>
    </a>

    <% if (user) { %>
        <!-- Logged-in user -->
        <div class="nav-button user-menu">
            <div class="user-trigger" onclick="toggleUserMenu()">
                <i class="fas fa-user"></i>
                <span>Hello, <%= user.name %></span>
                <i class="fas fa-caret-down"></i>
            </div>

            <div class="user-dropdown" id="userDropdown">
                <a href="/profile">
                    <i class="fas fa-id-badge"></i> Profile
                </a>
                <a href="/logout">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </a>
            </div>
        </div>
    <% } else { %>
        <!-- Guest user -->
        <a href="/login" class="nav-button">
            <i class="fas fa-sign-in-alt"></i>
            <span>Login</span>
        </a>

        <a href="/signup" class="nav-button">
            <i class="fas fa-user-plus"></i>
            <span>Sign Up</span>
        </a>
    <% } %>

</div>

        </div>

        <div class="black-nav">
            <div class="black-nav-container">
            </div>
        </div>
    </header>

    <script>
function toggleUserMenu() {
    const dropdown = document.getElementById("userDropdown");
    dropdown.style.display =
        dropdown.style.display === "block" ? "none" : "block";
}

document.addEventListener("click", function (e) {
    const menu = document.querySelector(".user-menu");
    if (menu && !menu.contains(e.target)) {
        document.getElementById("userDropdown").style.display = "none";
    }
});
</script>
